Bootstrap: docker
From: pytorch/pytorch:1.7.0-cuda11.0-cudnn8-runtime

%setup
    mkdir ${SINGULARITY_ROOTFS}/svm_models

%files
    ./heatmap_model.pt /
    ./trojan_detector.py /
    ./neuron.py /
    ./SCAn.py /
    ./utils.py /
    ./pytorch_ssim.py /
    ./gen_syn_data.py /

%post
    /opt/conda/bin/conda install pip
    /opt/conda/bin/conda install -c conda-forge imagemagick
    pip3 install trojai

%runscript
    exec python3 /trojan_detector.py "$@"
