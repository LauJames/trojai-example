Bootstrap: docker
From: pytorch/pytorch:latest

%setup
    mkdir ${SINGULARITY_ROOTFS}/svm_models

%files
    ./heatmap_model.pt /
    ./trojan_detector.py /
    ./neuron.py /
    ./SCAn.py /
    ./utils.py /
    ./pytorch_ssim.py /
    ./gen_syn_data.py /

%post
    /opt/conda/bin/conda install scikit-image
    /opt/conda/bin/conda install scikit-learn
    /opt/conda/bin/conda install pip
    /opt/conda/bin/conda install -c anaconda scipy
    /opt/conda/bin/conda install -c anaconda matplotlib
    pip3 install trojai

%runscript
    exec python3 /trojan_detector.py "$@"
